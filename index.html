<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>WhatsApp PDF Sender — Dashboard</title>
  <link href="style.css" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
  <div class="app">
    <aside class="sidebar">
      <h3 class="brand">WA PDF Sender</h3>
      <nav>
        <button class="nav-btn active" data-view="send">Send</button>
        <button class="nav-btn" data-view="bulk">Bulk</button>
        <button class="nav-btn" data-view="contacts">Contacts</button>
        <button class="nav-btn" data-view="logs">Logs</button>
        <button class="nav-btn" data-view="templates">Templates</button>
        <div class="spacer"></div>
        <small class="muted">Instance: <span id="instanceId">instance153584</span></small>
        <small class="muted">Sender: <span id="senderNumber">+94711314627</span></small>
      </nav>
    </aside>

    <main class="main">
      <header class="main-header">
        <h2 id="viewTitle">Send PDF/Image/Message</h2>
      </header>

      <!-- Send View -->
      <section id="view-send" class="view active">
        <div class="card p-3">
          <form id="sendForm" onsubmit="return false;">
            <div class="mb-3">
              <label class="form-label">Recipient number (international)</label>
              <input type="text" id="singleNumber" class="form-control" placeholder="+94123456789" />
            </div>

            <div class="mb-3">
              <label class="form-label">Send mode</label>
              <div>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="radio" name="sendMode" id="modeBoth" value="both" checked>
                  <label class="form-check-label" for="modeBoth">Send both (message + file)</label>
                </div>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="radio" name="sendMode" id="modeMsg" value="message">
                  <label class="form-check-label" for="modeMsg">Send only message</label>
                </div>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="radio" name="sendMode" id="modeFile" value="file">
                  <label class="form-check-label" for="modeFile">Send only file</label>
                </div>
              </div>
            </div>

            <div class="mb-3">
              <label class="form-label">Short message (optional)</label>
              <input type="text" id="singleMessage" class="form-control" placeholder="Optional message text" maxlength="300" />
            </div>

            <div class="mb-3">
              <label class="form-label">File (PDF or image)</label>
              <input type="file" id="singleFile" accept="application/pdf,image/*" class="form-control" />
              <div class="form-text">Max 10 MB recommended. PDF or image allowed.</div>
            </div>

            <div class="d-flex gap-2">
              <button type="button" id="sendSingleBtn" class="btn btn-primary">Send</button>
              <button type="button" id="saveContactBtn" class="btn btn-outline-secondary">Save to Contacts</button>
            </div>

            <div id="singleResult" class="mt-3"></div>
          </form>
        </div>
      </section>

      <!-- Bulk & Schedule View -->
      <section id="view-bulk" class="view">
        <div class="card p-3 mb-3">
          <h5>Bulk send (paste list, select contacts, or upload CSV)</h5>

          <!-- Saved contacts selector -->
          <div class="mb-3">
            <label class="form-label">Select saved contacts (optional)</label>
            <div id="bulkContactsList" class="border rounded p-2" style="max-height:120px; overflow:auto; cursor:pointer;">
              <div id="bulkSelectedContacts" class="small text-muted">Click to select contacts</div>
            </div>
            <div class="form-text small">Checked contacts will be included in bulk send. Use <code>{name}</code> in the message to personalize.</div>
          </div>

          <div class="mb-3">
            <label class="form-label">Paste numbers (one per line) OR upload CSV (single column)</label>
            <textarea id="bulkList" class="form-control" rows="5" placeholder="+94123456789"></textarea>
          </div>
          <div class="mb-3">
            <label class="form-label">Or upload CSV file</label>
            <input type="file" id="bulkCsv" accept=".csv,text/csv" class="form-control" />
          </div>

          <div class="mb-3">
            <label class="form-label">Message (optional)</label>
            <input type="text" id="bulkMessage" class="form-control" placeholder="Message to include with file (use {name} for recipient name)" />
          </div>

          <div class="mb-3">
            <label class="form-label">File (will be sent to every number) — PDF or image</label>
            <input type="file" id="bulkFile" accept="application/pdf,image/*" class="form-control" />
          </div>

          <div class="mb-3 d-flex gap-2">
            <button id="previewBulkBtn" class="btn btn-secondary">Preview List</button>
            <button id="sendBulkBtn" class="btn btn-primary">Send to All</button>
            <div class="form-text small">Rate-limited: 1 message / 1.2 seconds by default to protect the instance.</div>
          </div>

          <div id="bulkPreview" class="mt-3"></div>
        </div>

        <div class="card p-3">
          <h5>Scheduled Daily Send</h5>

          <!-- Saved contacts selector -->
          <div class="mb-3">
            <label class="form-label">Select saved contacts (optional)</label>
            <div id="scheduleContactsList" class="border rounded p-2" style="max-height:120px; overflow:auto; cursor:pointer;">
              <div id="scheduleSelectedContacts" class="small text-muted">Click to select contacts</div>
            </div>
            <div class="form-text small">Checked contacts will be included in scheduled send. Use <code>{name}</code> in the message to personalize.</div>
          </div>

          <div class="mb-3">
            <label class="form-label">Schedule time (HH:MM, server timezone)</label>
            <input type="time" id="scheduleTime" class="form-control" />
          </div>
          <div class="mb-3">
            <label class="form-label">Recipients (paste numbers or select contacts)</label>
            <textarea id="scheduleRecipients" class="form-control" rows="3" placeholder="+94123456789"></textarea>
          </div>

          <div class="mb-3">
            <label class="form-label">Message (optional)</label>
            <input id="scheduleMessage" class="form-control" placeholder="Message to send (use {name} for recipient name)" />
          </div>

          <div class="mb-3">
            <label class="form-label">PDF / Image to send (optional)</label>
            <input type="file" id="scheduleFile" accept="application/pdf,image/*" class="form-control" />
            <div class="form-text" id="scheduleFileLabel">No file selected</div>
          </div>

          <div class="d-flex gap-2 mb-2">
            <button id="saveScheduleBtn" class="btn btn-primary">Save Schedule</button>
            <button id="sendScheduleNowBtn" class="btn btn-outline-primary">Send Now</button>
          </div>
          <div id="scheduleList" class="mt-3"></div>
        </div>
      </section>

      <!-- Contacts View -->
      <section id="view-contacts" class="view">
        <div class="card p-3">
          <h5>Contacts (stored in browser)</h5>
          <div class="row g-2 mb-3">
            <div class="col-md-5"><input id="contactName" class="form-control" placeholder="Contact name" /></div>
            <div class="col-md-5"><input id="contactPhone" class="form-control" placeholder="+94123456789" /></div>
            <div class="col-md-2"><button id="addContactBtn" class="btn btn-primary w-100">Add</button></div>
          </div>
          <div id="contactsList"></div>
        </div>
      </section>

      <!-- Logs View -->
      <section id="view-logs" class="view">
        <div class="card p-3">
          <h5>Send Logs (server + browser)</h5>
          <div class="mb-3">
            <button id="exportCsvBtn" class="btn btn-sm btn-outline-secondary">Export CSV</button>
            <button id="clearLogsBtn" class="btn btn-sm btn-outline-danger">Clear Logs</button>
          </div>
          <div id="logsTable" class="table-responsive"></div>
        </div>
      </section>

      <!-- Templates View -->
      <section id="view-templates" class="view">
        <div class="card p-3">
          <h5>Templates</h5>
          <div class="row g-2 mb-3">
            <div class="col-md-9"><input id="templateText" class="form-control" placeholder="Template text" /></div>
            <div class="col-md-3"><button id="saveTplBtn" class="btn btn-primary w-100">Save Template</button></div>
          </div>
          <div id="templatesList"></div>
        </div>
      </section>

    </main>
  </div>

  <script src="app.js"></script>
</body>
</html>
